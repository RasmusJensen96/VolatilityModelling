Estimate_GARCH <- function(vY,Dates) {
  ## Function fitting or estimatinig a GARCH(1,1)-model on a certain vector of data
  ## Input:  vY:      Data-vector
  ## output: vPar:    parameters resulting in the maximum likeliihood given data c(omega, alpha, beta)
  ##         dLLK:    Value of the likelihood at the Maximum likelihood given data and estimated parameters
  ##         BIC:     Average BIC value at the (numerical) maximum likelihood estimate
  ##         Filter: Vector of conditional variances (squared cond. volatilty)

  # Initialize the values at some arbitrary values, except omega initialized at the unconditional value.
  require(Rsolnp)
  dAlpha = 0.05
  dBeta  = 0.94
  dOmega = var(vY) * (1.0 - dAlpha - dBeta)
  vPar = c(dOmega, dAlpha, dBeta)
  ## Optimize using the non-linear solnp, allowing for inequality constraints such as the one contained in
  ## StationarityConstr ensuring htat the estimated model is covariance (weakly) stationary
  optimizer = solnp(vPar, fun = LLH_GARCH11, vY = vY,
                    ineqfun = StationarityConstr,
                    ineqLB  = 0,
                    ineqUB = 0.99999,
                    LB = c(0.00001, 0.0001, 0.0001), UB = c(10.0, 0.999, 0.999))

  ## extract estimated parameters
  vPar = optimizer$pars
  ## extract the likelihood computed at its maximum
  dLLK = -tail(optimizer$values, 1)
  ## compute filtered Variance
  vSigma2 = GARCH11_Filter(vY, vPar[1], vPar[2], vPar[3])$vSigma2
  ## Compute the Average BIC
  ABIC = (-2 * dLLK + log(length(vY)) * length(vPar))/length(vY)
  ## return a list with estimated parameters, likelihood value and BIC
  lOut = list(vPar = vPar,
              dLLK = dLLK,
              BIC = ABIC,
              Filtered = vSigma2,
              Observations = vY,
              Model = "GARCH",
              Dist = "Gaussian",
              Dates = Dates)
  class(lOut) <- "FitModel"
  return(lOut)
}
